#!/bin/sh

# Show wifi ğŸ“¶ and percent strength or ğŸ“¡ if none.
# Show ğŸŒ if connected to ethernet or â if none.

# ğŸ“¡: no wifi connection
# ğŸ“¶: wifi connection with quality
# â: no ethernet
# ğŸŒ: ethernet working
case $BLOCK_BUTTON in
	1) "$TERMINAL" -e nmtui; pkill -RTMIN+4 dwmblocks ;;
	3) notify-send "ï‚¬  Internet module" "\- Click to connect
ï€ : no wifi connection
ï‡« : wifi connection with quality
ï€ : no ethernet
ï‚¬ : ethernet working
" ;;
	6) "$TERMINAL" -e "$EDITOR" "$0" ;;
esac

con_quality=$(awk '/^\s*w/ { print int($3 * 100 / 70) }' /proc/net/wireless) || break

case "$(cat /sys/class/net/w*/operstate 2>/dev/null)" in
  down) case "$(cat /sys/class/net/e*/operstate 2>/dev/null || echo ï€)" in
          down) ethicon=""; wifiicon="ï€" ;;
          up) ethicon=" ï‚¬" ;;
          *) ethicon="ï€" ;;
        esac
        wifiicon="" ;;
  up) if [ "$con_quality" -gt 90 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#6db111^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
  elif [ "$con_quality" -gt 80 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#76b111^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
  elif [ "$con_quality" -gt 70 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#9ebe02^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
  elif [ "$con_quality" -gt 60 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#b5c402^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
  elif [ "$con_quality" -gt 50 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#cdca09^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
  elif [ "$con_quality" -gt 40 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#eea900^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
  elif [ "$con_quality" -gt 30 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#ea8b00^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
  elif [ "$con_quality" -gt 20 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#e36b02^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
  elif [ "$con_quality" -gt 10 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#d94912^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
  elif [ "$con_quality" -gt 1 ]; then
    wifiicon="$(awk '/^\s*w/ { print "^c#cc1d1d^ ï‡«  ^d^", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
      fi
esac

printf "%s%s\n" "$wifiicon" "$ethicon"
